<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.52" />

  <title>Using local-exec and remote-exec provisioners with terraform &middot; Things I find interesting</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://sdorsett.github.io/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://sdorsett.github.io/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://sdorsett.github.io/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="https://sdorsett.github.ioimg/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="https://sdorsett.github.io/"> </a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sdorsett.github.io/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sdorsett.github.io/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sdorsett.github.io/topics/"><i class='fa fa-folder fa-fw'></i>Topics</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sdorsett.github.io/tags/"><i class='fa fa-tags fa-fw'></i>Tags</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://github.com/sdorsett/interesting-links"><i class='fa fa-folder fa-fw'></i>Favorites</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://sdorsett.github.io/about/">About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/standorsett" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/stan-dorsett-53a8827" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/sdorsett" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2018. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Using local-exec and remote-exec provisioners with terraform</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 Dec 2018, 00:00</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="https://sdorsett.github.iotopics/learning-terraform-by-deploying-to-vsphere">learning-terraform-by-deploying-to-vsphere</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://sdorsett.github.iotags/terraform">terraform</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://sdorsett.github.iotags/vsphere">vsphere</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://sdorsett.github.iotags/kubernetes">kubernetes</a>
    
  </div>
  
  

</div>

  

<p>This is the fourth in a series of posts that will walk you through using terraform to deploy and configure virtual machines on vsphere. In this post you will get introduced to using local-exec and remote-exe provisioners to make local (on the deloying system) and remote (on the deployed system) changes. If everything goes right we will also have a functional kubernetes controller that we can build on in future posts.</p>

<p>One thing to mention early on in this post is that it is written expecting to deploy from a CentOS 7 template. All the bash scripts we will be using to configure the deployed virtual machine are written to install and configure a CentOS 7 virtual machine, so consider yourself warned.</p>

<hr />

<h3 id="1-create-a-new-directory-for-our-terraform-code">1. Create a new directory for our terraform code.</h3>

<p>Start by creating a new directory for the terraform code and <code>cd</code> to it.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform ~<span style="color:#f92672">]</span><span style="color:#75715e"># mkdir terraform-vsphere-kubernetes</span>
<span style="color:#f92672">[</span>root@terraform ~<span style="color:#f92672">]</span><span style="color:#75715e"># cd terraform-vsphere-kubernetes/</span>
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h3 id="2-create-variables-tf-containing-the-variables-that-are-required">2. Create <code>variables.tf</code> containing the variables that are required.</h3>

<p>In the past blog post we used a simple <code>variables.tf</code>file consisting of variables with string values. In this post I thought we could use maps to group the variables so that they were better organized. Let us start with a new variables.tf file that contains all our variables and their default values:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat variables.tf</span>
variable <span style="color:#e6db74">&#34;vsphere_connection&#34;</span> <span style="color:#f92672">{</span>
  type                      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;map&#34;</span>
  description               <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Configuration details for connecting to vsphere&#34;</span>

  default <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e"># vsphere login account. defaults to administrator@vsphere.local account</span>
    vsphere_user            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;administrator@vsphere.local&#34;</span>
    <span style="color:#75715e"># vsphere account password. empty by default</span>
    vsphere_password        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#75715e"># vsphere server, defaults to localhost</span>
    vsphere_server          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

variable <span style="color:#e6db74">&#34;virtual_machine_template&#34;</span> <span style="color:#f92672">{</span>
  type                      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;map&#34;</span>
  description               <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Configuration details for virtual machine template&#34;</span>

  default <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e"># name of the template to deploy from. empty by default</span>
    name                    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#75715e"># default connection_type to SSH</span>
    connection_type         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ssh&#34;</span>
    <span style="color:#75715e"># username to connect to deployed virtual machines. defaults to &#34;root&#34;</span>
    connection_user         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;root&#34;</span>
    <span style="color:#75715e"># default password to initially connect to deployed virtual machines. empty by default</span>
    connection_password     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#75715e"># vsphere datacenter that the template is located in. empty by default</span>
    datacenter <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

variable <span style="color:#e6db74">&#34;virtual_machine_kubernetes_controller&#34;</span> <span style="color:#f92672">{</span>
  type                      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;map&#34;</span>
  description               <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Configuration details for kubernetes_controller virtual machine&#34;</span>

  default <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e"># name of the virtual machine to be deployed. defaults to &#34;kubernetes-controller&#34;</span>
    name                    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;kubernetes-controller&#34;</span>
    <span style="color:#75715e"># name of the datastore to deploy kubernetes_controller to. defaults to &#34;datastore1&#34;</span>
    datastore               <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;datastore1&#34;</span>
    <span style="color:#75715e"># name of network to deploy kubernetes_controller to. defaults to &#34;VM Network&#34;</span>
    network                 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;VM Network&#34;</span>
    <span style="color:#75715e"># ip address to be assigned to kubernetes_controller. empty by default</span>
    ip_address              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#75715e"># netmask assigned to kubernetes_controller. defaults to &#34;24&#34;</span>
    netmask                 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;24&#34;</span>
    <span style="color:#75715e"># dns server assigned to kubernetes_controller. defaults to &#34;8.8.8.8&#34;</span>
    dns_server              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;8.8.8.8&#34;</span>
    <span style="color:#75715e"># default gateway to be assigned to kubernetes_controller. empty by default</span>
    gateway                 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#75715e"># resource pool to deploy kubernetes_controller to. empty by default</span>
    resource_pool           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
    <span style="color:#75715e"># private key to be used for SSH connections - this will be generated/overwritten on a terraform apply</span>
    private_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/root/.ssh/id_rsa-terraform-vsphere-kubernetes&#34;</span>
    <span style="color:#75715e"># public key to be copied to virtual machine</span>
    public_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/root/.ssh/id_rsa-terraform-vsphere-kubernetes.pub&#34;</span>
    <span style="color:#75715e"># number of vcpu assigned to kubernetes_controller. default is 2</span>
    num_cpus <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#75715e"># amount of memory assigned to kubernetes_controller. default is 4096 (4GB)</span>
    memory   <span style="color:#f92672">=</span> <span style="color:#ae81ff">4096</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span></code></pre></div>

<p>In this <code>variables.tf</code> we have 3 base variables that are of the map type:</p>

<ul>
<li>vsphere_connection - for vsphere connection related details</li>
<li>virtual_machine_template - for details about the template we will be cloning</li>
<li>virtual_machine_kubernetes_controller - for details about the kubernetes_controller virtual machine that will be deployed</li>
</ul>

<p>Variables that have a type of <code>map</code> are hashes that contain keys, and each of those keys has assigned values. This structure lets us keep related pieces of information together and also helps make it more clear as far as what resources the variables are related to.</p>

<h3 id="3-create-terraform-tfvars-and-set-the-variable-values">3. Create <code>terraform.tfvars</code> and set the variable values.</h3>

<p>Just like we did we showed in the previous post, we will use the <code>terraform.tfvars</code> file to set the specific values of the variables defined in <code>variables.tf</code> for our environment. By keeping the actual value outside of the <code>variables.tf</code> we can add <code>terraform.tfvars</code> to our <code>.gitignore</code> file and keep our remote git repository free from the details of this environment:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat terraform.tfvars</span>
vsphere_connection <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
  vsphere_user <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;terraform_user@vsphere.local&#34;</span>
  vsphere_password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SuperSecretPassword&#34;</span>
  vsphere_server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.100.50&#34;</span>
<span style="color:#f92672">}</span>
virtual_machine_template <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
  name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;standorsett-centos-7&#34;</span>
  datacenter <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;datacenter&#34;</span>
  connection_password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;vagrant&#34;</span>
<span style="color:#f92672">}</span>
virtual_machine_kubernetes_controller <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
  name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;kubernetes-controller&#34;</span>
  datastore <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;datastore-1&#34;</span>
  network <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;kubernetes-portgroup&#34;</span>
  ip_address <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.100.100&#34;</span>
  netmask <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;24&#34;</span>
  dns_server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.100.1&#34;</span>
  gateway <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.100.1&#34;</span>
  resource_pool <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cluster/Resources&#34;</span>
<span style="color:#f92672">}</span>
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h3 id="4-create-kubernetes-controller-tf-to-contain-our-terraform-code-for-creating-the-kubernetes-controller-virtual-machine">4. Create <code>kubernetes_controller.tf</code> to contain our terraform code for creating the kubernetes_controller virtual machine.</h3>

<p>Next we will create <code>kubernetes_controller.tf</code> to contain the terraform code that will create the virtual machine resource:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">provider <span style="color:#e6db74">&#34;vsphere&#34;</span> <span style="color:#f92672">{</span>
  user           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.vsphere_connection.[<span style="color:#e6db74">&#34;vsphere_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  password       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.vsphere_connection.[<span style="color:#e6db74">&#34;vsphere_password&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  vsphere_server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.vsphere_connection.[<span style="color:#e6db74">&#34;vsphere_server&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  allow_unverified_ssl <span style="color:#f92672">=</span> true
<span style="color:#f92672">}</span>

data <span style="color:#e6db74">&#34;vsphere_datacenter&#34;</span> <span style="color:#e6db74">&#34;template_datacenter&#34;</span> <span style="color:#f92672">{</span>
  name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;datacenter&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

data <span style="color:#e6db74">&#34;vsphere_datastore&#34;</span> <span style="color:#e6db74">&#34;vm_datastore&#34;</span> <span style="color:#f92672">{</span>
  name          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;datastore&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  datacenter_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_datacenter.template_datacenter.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

data <span style="color:#e6db74">&#34;vsphere_resource_pool&#34;</span> <span style="color:#e6db74">&#34;vm_resource_pool&#34;</span> <span style="color:#f92672">{</span>
  name          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;resource_pool&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  datacenter_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_datacenter.template_datacenter.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

data <span style="color:#e6db74">&#34;vsphere_network&#34;</span> <span style="color:#e6db74">&#34;vm_network&#34;</span> <span style="color:#f92672">{</span>
  name          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;network&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  datacenter_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_datacenter.template_datacenter.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

data <span style="color:#e6db74">&#34;vsphere_virtual_machine&#34;</span> <span style="color:#e6db74">&#34;template&#34;</span> <span style="color:#f92672">{</span>
  name          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;name&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  datacenter_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_datacenter.template_datacenter.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

resource <span style="color:#e6db74">&#34;vsphere_virtual_machine&#34;</span> <span style="color:#e6db74">&#34;kubernetes_controller&#34;</span> <span style="color:#f92672">{</span>
  name             <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;name&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  resource_pool_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_resource_pool.vm_resource_pool.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  datastore_id     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_datastore.vm_datastore.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

  num_cpus <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;num_cpus&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  memory   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;memory&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  guest_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_virtual_machine.template.guest_id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

  scsi_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_virtual_machine.template.scsi_type<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

  network_interface <span style="color:#f92672">{</span>
    network_id   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_network.vm_network.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    adapter_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_virtual_machine.template.network_interface_types[0]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#f92672">}</span>

  disk <span style="color:#f92672">{</span>
    label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;disk0&#34;</span>
    size <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_virtual_machine.template.disks.0.size<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#f92672">}</span>

  clone <span style="color:#f92672">{</span>
    template_uuid <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>data.vsphere_virtual_machine.template.id<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

    customize <span style="color:#f92672">{</span>
      linux_options <span style="color:#f92672">{</span>
        host_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;name&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
        domain    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;kubernetes.local&#34;</span>
      <span style="color:#f92672">}</span>

      dns_server_list <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;dns_server&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">]</span>
      dns_suffix_list <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;kubernetes.local&#34;</span><span style="color:#f92672">]</span>

      network_interface <span style="color:#f92672">{</span>
        ipv4_address <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;ip_address&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
        ipv4_netmask <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;netmask&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      <span style="color:#f92672">}</span>

      ipv4_gateway <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;gateway&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

  provisioner <span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#f92672">{</span>
    source      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;public_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    destination <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/tmp/authorized_keys&#34;</span>

    connection <span style="color:#f92672">{</span>
      type        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      password    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_password&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

  provisioner <span style="color:#e6db74">&#34;remote-exec&#34;</span> <span style="color:#f92672">{</span>
    inline <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      <span style="color:#e6db74">&#34;mkdir -p /root/.ssh/&#34;</span>,
      <span style="color:#e6db74">&#34;chmod 700 /root/.ssh&#34;</span>,
      <span style="color:#e6db74">&#34;mv /tmp/authorized_keys /root/.ssh/authorized_keys&#34;</span>,
      <span style="color:#e6db74">&#34;chmod 600 /root/.ssh/authorized_keys&#34;</span>,
      <span style="color:#e6db74">&#34;sed -i &#39;s/#PasswordAuthentication.*/PasswordAuthentication no/&#39; /etc/ssh/sshd_config&#34;</span>,
      <span style="color:#e6db74">&#34;service sshd restart&#34;</span>
    <span style="color:#f92672">]</span>
    connection <span style="color:#f92672">{</span>
      type          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      password      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_password&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

  provisioner <span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#f92672">{</span>
    source      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./scripts/&#34;</span>
    destination <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/tmp/&#34;</span>

    connection <span style="color:#f92672">{</span>
      type        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      private_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>file(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;private_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

  provisioner <span style="color:#e6db74">&#34;remote-exec&#34;</span> <span style="color:#f92672">{</span>
    inline <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      <span style="color:#e6db74">&#34;chmod +x /tmp/*sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/system_setup.sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/install_docker.sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/install_kubernetes_packages.sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/kubeadm_init.sh&#34;</span>,
      <span style="color:#e6db74">&#34;tail -n2 /tmp/kubeadm_init_output.txt | head -n 1&#34;</span>,
    <span style="color:#f92672">]</span>
    connection <span style="color:#f92672">{</span>
      type          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      private_key   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>file(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;private_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>

<span style="color:#f92672">}</span></code></pre></div>

<p>There are several things in this <code>.tf</code> that are different from the the previous post:</p>

<ul>
<li>variables are now using the var.<variable_name>.[&rdquo;<property>&rdquo;] format. As I mentioned earlier this makes our variables.tf file more logical in how it is organized</li>
<li>the <code>vsphere_virtual_machine.kubernetes_controller</code> resource that is being deployed has a <code>customize</code> block that describes guest customization that need to be applied to the deploye virtual machine. This allows us to specify that IP address, netmask, gateway, DNS server and hostname of the deployed virtual machine.</li>
<li>the <code>vsphere_virtual_machine.kubernetes_controller</code> resource has provisioner blocks that allow us to copy files and remotely run commands on the deployed virtual machine.</li>
</ul>

<p>The provisioner blocks that perform the configuration of the deployed virtual machine are the following:</p>

<ul>
<li>the <code>file</code> provisioner is used to copy the ssh public key to <code>/tmp/authorized_keys</code> on the deployed virtual machine. I want to point out that the connection block will be using the <code>password</code> parameter to use the default password setup in the template to connect.</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  provisioner <span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#f92672">{</span>
    source      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;public_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    destination <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/tmp/authorized_keys&#34;</span>

    connection <span style="color:#f92672">{</span>
      type        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      password    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_password&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span></code></pre></div>

<ul>
<li>the <code>remote-exec</code> provisioner will run the command listed in the inline block on the deployed virtual machine. The commands will move the <code>/tmp/authorized_keys</code> file that was copied in the previous step to <code>/root/.ssh/</code> and change the permissions. This block will finally disable password ssh authentication in <code>/etc/ssh/sshd_config</code> and restart the sshd service so the changes take affect:</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  provisioner <span style="color:#e6db74">&#34;remote-exec&#34;</span> <span style="color:#f92672">{</span>
    inline <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      <span style="color:#e6db74">&#34;mkdir -p /root/.ssh/&#34;</span>,
      <span style="color:#e6db74">&#34;chmod 700 /root/.ssh&#34;</span>,
      <span style="color:#e6db74">&#34;mv /tmp/authorized_keys /root/.ssh/authorized_keys&#34;</span>,
      <span style="color:#e6db74">&#34;chmod 600 /root/.ssh/authorized_keys&#34;</span>,
      <span style="color:#e6db74">&#34;sed -i &#39;s/#PasswordAuthentication.*/PasswordAuthentication no/&#39; /etc/ssh/sshd_config&#34;</span>,
      <span style="color:#e6db74">&#34;service sshd restart&#34;</span>
    <span style="color:#f92672">]</span>
    connection <span style="color:#f92672">{</span>
      type          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      password      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_password&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span></code></pre></div>

<ul>
<li>The next <code>file</code> provisioner block will copy all files located in the local <code>scripts/</code> directory to <code>/tmp/</code> on the deployed virtual machine. Notice that the connection block is no longer using the <code>password</code> option, but is now using <code>private_key</code> to connect using the ssh key that will be generated.</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  provisioner <span style="color:#e6db74">&#34;file&#34;</span> <span style="color:#f92672">{</span>
    source      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./scripts/&#34;</span>
    destination <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/tmp/&#34;</span>

    connection <span style="color:#f92672">{</span>
      type        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      private_key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>file(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;private_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span></code></pre></div>

<ul>
<li>the last <code>remote-exec</code> block will make all the <code>.sh</code> files in <code>/tmp/</code> executable, run the listed <code>.sh</code> files and finally output a line from <code>/tmp/kubeadm_init_output.txt</code> that is denerated when running the <code>/tmp/kubeadm_init.sh</code> script:</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">  provisioner <span style="color:#e6db74">&#34;remote-exec&#34;</span> <span style="color:#f92672">{</span>
    inline <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      <span style="color:#e6db74">&#34;chmod +x /tmp/*sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/system_setup.sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/install_docker.sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/install_kubernetes_packages.sh&#34;</span>,
      <span style="color:#e6db74">&#34;sudo /tmp/kubeadm_init.sh&#34;</span>,
      <span style="color:#e6db74">&#34;tail -n2 /tmp/kubeadm_init_output.txt | head -n 1&#34;</span>,
    <span style="color:#f92672">]</span>
    connection <span style="color:#f92672">{</span>
      type          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_type&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      user          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_template.[<span style="color:#e6db74">&#34;connection_user&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      private_key   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>file(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;private_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span></code></pre></div>

<h3 id="5-create-the-scripts-directory-and-the-files-that-will-be-repotely-run-to-configure-the-virtual-machine-as-needed">5. Create the `scripts directory and the files that will be repotely run to configure the virtual machine as needed</h3>

<ul>
<li>We now need to create the scripts that the last <code>remote-exec</code> provisioner will be running on the deployed virtual machine. First create the scripts directory:</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># mkdir scripts</span>
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<ul>
<li>Secondly we need to create the <code>system_setup.sh</code> that will disable swap, disable the firewall and disable SELINUX</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat scripts/system_setup.sh</span>
<span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>
<span style="color:#75715e"># disable swap since kubeadm documentation suggests disabling it</span>
swapoff -a
sed -i <span style="color:#e6db74">&#39;/swap/d&#39;</span> /etc/fstab

<span style="color:#75715e"># disable firewalld and SELinux</span>
systemctl disable firewalld
systemctl stop firewalld
sed -i <span style="color:#e6db74">&#39;s/SELINUX=enforcing/SELINUX=disabled/g&#39;</span> /etc/selinux/config
setenforce <span style="color:#ae81ff">0</span>
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<ul>
<li>The next script that will run is <code>install_docker.sh</code> which will install docker and configure the systemd service to start docker.</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat scripts/install_docker.sh</span>
<span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>
<span style="color:#75715e">## Install prerequisites.</span>
yum install yum-utils device-mapper-persistent-data lvm2 -y

<span style="color:#75715e">## Add docker repository.</span>
yum-config-manager <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    --add-repo <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    https://download.docker.com/linux/centos/docker-ce.repo

<span style="color:#75715e">## Install docker.</span>
yum update -y <span style="color:#f92672">&amp;&amp;</span> yum install docker-ce-18.06.1.ce -y

<span style="color:#75715e">## Create /etc/docker directory.</span>
mkdir /etc/docker

<span style="color:#75715e"># Setup daemon.</span>
cat &gt; /etc/docker/daemon.json <span style="color:#e6db74">&lt;&lt;EOF
</span><span style="color:#e6db74">{
</span><span style="color:#e6db74">  &#34;exec-opts&#34;: [&#34;native.cgroupdriver=systemd&#34;],
</span><span style="color:#e6db74">  &#34;log-driver&#34;: &#34;json-file&#34;,
</span><span style="color:#e6db74">  &#34;log-opts&#34;: {
</span><span style="color:#e6db74">    &#34;max-size&#34;: &#34;100m&#34;
</span><span style="color:#e6db74">  },
</span><span style="color:#e6db74">  &#34;storage-driver&#34;: &#34;overlay2&#34;,
</span><span style="color:#e6db74">  &#34;storage-opts&#34;: [
</span><span style="color:#e6db74">    &#34;overlay2.override_kernel_check=true&#34;
</span><span style="color:#e6db74">  ]
</span><span style="color:#e6db74">}
</span><span style="color:#e6db74">EOF</span>

mkdir -p /etc/systemd/system/docker.service.d

<span style="color:#75715e"># Restart docker.</span>
systemctl daemon-reload
systemctl restart docker
systemctl enable docker
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<ul>
<li>The next script that runs will be the <code>install_kubernetes_packages.sh</code> script which will install the kubernetes repo and packages:</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat scripts/install_kubernetes_packages.sh</span>
<span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>
cat <span style="color:#e6db74">&lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
</span><span style="color:#e6db74">[kubernetes]
</span><span style="color:#e6db74">name=Kubernetes
</span><span style="color:#e6db74">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
</span><span style="color:#e6db74">enabled=1
</span><span style="color:#e6db74">gpgcheck=1
</span><span style="color:#e6db74">repo_gpgcheck=1
</span><span style="color:#e6db74">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span><span style="color:#e6db74">exclude=kube*
</span><span style="color:#e6db74">EOF</span>

<span style="color:#75715e"># Set SELinux in permissive mode (effectively disabling it)</span>
setenforce <span style="color:#ae81ff">0</span>
sed -i <span style="color:#e6db74">&#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39;</span> /etc/selinux/config

yum install -y nfs-utils kubelet kubeadm kubectl openssl --disableexcludes<span style="color:#f92672">=</span>kubernetes

systemctl enable kubelet <span style="color:#f92672">&amp;&amp;</span> systemctl start kubelet

cat <span style="color:#e6db74">&lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-ip6tables = 1
</span><span style="color:#e6db74">net.bridge.bridge-nf-call-iptables = 1
</span><span style="color:#e6db74">EOF</span>

sysctl --system
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<ul>
<li>the last script we will run is <code>kubeadm_init.sh</code> which will run the kubeadmin command to initialized a kubernetes controller on the deployed virtual machine:</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat scripts/kubeadm_init.sh</span>
<span style="color:#75715e">#! /bin/bash
</span><span style="color:#75715e"></span>IPADDRESS<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ip address show dev eth0 | grep <span style="color:#e6db74">&#39;inet &#39;</span> | awk <span style="color:#e6db74">&#39;{print $2}&#39;</span> | cut -d<span style="color:#e6db74">&#34;/&#34;</span> -f1<span style="color:#66d9ef">)</span>
echo <span style="color:#e6db74">&#34;--&gt; pull kubeadm images &lt;--&#34;</span>
kubeadm config images pull

echo <span style="color:#e6db74">&#34;--&gt; run &#39;kubeadm init&#39; &lt;--&#34;</span>
kubeadm init --apiserver-advertise-address<span style="color:#f92672">=</span>$IPADDRESS --pod-network-cidr<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>.244.0.0/16 &gt; /tmp/kubeadm_init_output.txt

echo <span style="color:#e6db74">&#34;--&gt; setup </span>$HOME<span style="color:#e6db74">/.kube/config &lt;--&#34;</span>
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown <span style="color:#66d9ef">$(</span>id -u<span style="color:#66d9ef">)</span>:<span style="color:#66d9ef">$(</span>id -g<span style="color:#66d9ef">)</span> $HOME/.kube/config

echo <span style="color:#e6db74">&#34;--&gt; install flannel &lt;--&#34;</span>
kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml

<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h3 id="6-create-output-tf-containing-the-information-we-want-terraform-to-return-after-a-run-completes">6. Create <code>output.tf</code> containing the information we want terraform to return after a run completes.</h3>

<p>In the output.tf you can specify what information terraform should display after the run completes.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat output.tf</span>
output <span style="color:#e6db74">&#34;ip&#34;</span> <span style="color:#f92672">{</span>
   value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>vsphere_virtual_machine.kubernetes_controller.*.default_ip_address<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>
output <span style="color:#e6db74">&#34;vm-moref&#34;</span> <span style="color:#f92672">{</span>
   value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>vsphere_virtual_machine.kubernetes_controller.moid<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<p>In this example, just like in the previous post,  terraform will return the ip address and moref of the virtual machine created.</p>

<h3 id="7-create-ssh-key-tf-to-contain-our-terraform-code-for-creating-a-ssh-key-for-connecting-to-the-deployed-virtual-machine">7. Create <code>ssh-key.tf</code> to contain our terraform code for creating a ssh key for connecting to the deployed virtual machine.</h3>

<p>The following is the terraform code that I used to create a ssh key. It is using the <code>local-exec</code> provisioner to run command on the machine that is running the terraform code.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># cat ssh-key.tf</span>
resource <span style="color:#e6db74">&#34;null_resource&#34;</span> <span style="color:#e6db74">&#34;generate-sshkey&#34;</span> <span style="color:#f92672">{</span>
    provisioner <span style="color:#e6db74">&#34;local-exec&#34;</span> <span style="color:#f92672">{</span>
        command <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;yes y | ssh-keygen -b 4096 -t rsa -C &#39;terraform-vsphere-kubernetes&#39; -N &#39;&#39; -f </span><span style="color:#e6db74">${</span>var.virtual_machine_kubernetes_controller.[<span style="color:#e6db74">&#34;private_key&#34;</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h3 id="8-run-terraform-init-to-initialize-terraform-and-downloaded-the-provisioners">8. Run <code>terraform init</code> to initialize terraform and downloaded the provisioners.</h3>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># terraform init</span>

Initializing provider plugins...
- Checking <span style="color:#66d9ef">for</span> available provider plugins on https://releases.hashicorp.com...
- Downloading plugin <span style="color:#66d9ef">for</span> provider <span style="color:#e6db74">&#34;vsphere&#34;</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>.9.0<span style="color:#f92672">)</span>...
- Downloading plugin <span style="color:#66d9ef">for</span> provider <span style="color:#e6db74">&#34;null&#34;</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>.0.0<span style="color:#f92672">)</span>...

The following providers <span style="color:#66d9ef">do</span> not have any version constraints in configuration,
so the latest version was installed.

To prevent automatic upgrades to new major versions that may contain breaking
changes, it is recommended to add version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;...&#34;</span> constraints to the
corresponding provider blocks in configuration, with the constraint strings
suggested below.

* provider.null: version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~&gt; 1.0&#34;</span>
* provider.vsphere: version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~&gt; 1.9&#34;</span>

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running <span style="color:#e6db74">&#34;terraform plan&#34;</span> to see
any changes that are required <span style="color:#66d9ef">for</span> your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration <span style="color:#66d9ef">for</span> Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to <span style="color:#66d9ef">do</span> so <span style="color:#66d9ef">if</span> necessary.
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h3 id="9-run-terraform-plan-to-have-terraform-show-what-will-get-created">9. Run <code>terraform plan</code> to have terraform show what will get created.</h3>

<p>The next step is to run <code>terraform plan</code> to have terraform validate the vsphere credentials and display the changes it would like to make:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># terraform plan</span>
Refreshing Terraform state in-memory prior to plan...
The refreshed state will be used to calculate this plan, but will not be
persisted to local or remote state storage.

data.vsphere_datacenter.template_datacenter: Refreshing state...
data.vsphere_virtual_machine.template: Refreshing state...
data.vsphere_network.vm_network: Refreshing state...
data.vsphere_resource_pool.vm_resource_pool: Refreshing state...
data.vsphere_datastore.vm_datastore: Refreshing state...

------------------------------------------------------------------------

An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  + null_resource.generate-sshkey
      id:                                                   &lt;computed&gt;

  + vsphere_virtual_machine.kubernetes_controller
      id:                                                   &lt;computed&gt;
      boot_retry_delay:                                     <span style="color:#e6db74">&#34;10000&#34;</span>
      change_version:                                       &lt;computed&gt;
      clone.#:                                              <span style="color:#e6db74">&#34;1&#34;</span>
      clone.0.customize.#:                                  <span style="color:#e6db74">&#34;1&#34;</span>
      clone.0.customize.0.dns_server_list.#:                <span style="color:#e6db74">&#34;1&#34;</span>
      clone.0.customize.0.dns_server_list.0:                <span style="color:#e6db74">&#34;192.168.100.1&#34;</span>
      clone.0.customize.0.dns_suffix_list.#:                <span style="color:#e6db74">&#34;1&#34;</span>
      clone.0.customize.0.dns_suffix_list.0:                <span style="color:#e6db74">&#34;kubernetes.local&#34;</span>
      clone.0.customize.0.ipv4_gateway:                     <span style="color:#e6db74">&#34;192.168.100.1&#34;</span>
      clone.0.customize.0.linux_options.#:                  <span style="color:#e6db74">&#34;1&#34;</span>
      clone.0.customize.0.linux_options.0.domain:           <span style="color:#e6db74">&#34;kubernetes.local&#34;</span>
      clone.0.customize.0.linux_options.0.host_name:        <span style="color:#e6db74">&#34;kubernetes-controller&#34;</span>
      clone.0.customize.0.linux_options.0.hw_clock_utc:     <span style="color:#e6db74">&#34;true&#34;</span>
      clone.0.customize.0.network_interface.#:              <span style="color:#e6db74">&#34;1&#34;</span>
      clone.0.customize.0.network_interface.0.ipv4_address: <span style="color:#e6db74">&#34;192.168.100.100&#34;</span>
      clone.0.customize.0.network_interface.0.ipv4_netmask: <span style="color:#e6db74">&#34;24&#34;</span>
      clone.0.customize.0.timeout:                          <span style="color:#e6db74">&#34;10&#34;</span>
      clone.0.template_uuid:                                <span style="color:#e6db74">&#34;4221e272-e449-97e0-39f4-ab580bebc473&#34;</span>
      clone.0.timeout:                                      <span style="color:#e6db74">&#34;30&#34;</span>
      cpu_limit:                                            <span style="color:#e6db74">&#34;-1&#34;</span>
      cpu_share_count:                                      &lt;computed&gt;
      cpu_share_level:                                      <span style="color:#e6db74">&#34;normal&#34;</span>
      datastore_id:                                         <span style="color:#e6db74">&#34;datastore-15&#34;</span>
      default_ip_address:                                   &lt;computed&gt;
      disk.#:                                               <span style="color:#e6db74">&#34;1&#34;</span>
      disk.0.attach:                                        <span style="color:#e6db74">&#34;false&#34;</span>
      disk.0.datastore_id:                                  <span style="color:#e6db74">&#34;&lt;computed&gt;&#34;</span>
      disk.0.device_address:                                &lt;computed&gt;
      disk.0.disk_mode:                                     <span style="color:#e6db74">&#34;persistent&#34;</span>
      disk.0.disk_sharing:                                  <span style="color:#e6db74">&#34;sharingNone&#34;</span>
      disk.0.eagerly_scrub:                                 <span style="color:#e6db74">&#34;false&#34;</span>
      disk.0.io_limit:                                      <span style="color:#e6db74">&#34;-1&#34;</span>
      disk.0.io_reservation:                                <span style="color:#e6db74">&#34;0&#34;</span>
      disk.0.io_share_count:                                <span style="color:#e6db74">&#34;0&#34;</span>
      disk.0.io_share_level:                                <span style="color:#e6db74">&#34;normal&#34;</span>
      disk.0.keep_on_remove:                                <span style="color:#e6db74">&#34;false&#34;</span>
      disk.0.key:                                           <span style="color:#e6db74">&#34;0&#34;</span>
      disk.0.label:                                         <span style="color:#e6db74">&#34;disk0&#34;</span>
      disk.0.path:                                          &lt;computed&gt;
      disk.0.size:                                          <span style="color:#e6db74">&#34;8&#34;</span>
      disk.0.thin_provisioned:                              <span style="color:#e6db74">&#34;true&#34;</span>
      disk.0.unit_number:                                   <span style="color:#e6db74">&#34;0&#34;</span>
      disk.0.uuid:                                          &lt;computed&gt;
      disk.0.write_through:                                 <span style="color:#e6db74">&#34;false&#34;</span>
      ept_rvi_mode:                                         <span style="color:#e6db74">&#34;automatic&#34;</span>
      firmware:                                             <span style="color:#e6db74">&#34;bios&#34;</span>
      force_power_off:                                      <span style="color:#e6db74">&#34;true&#34;</span>
      guest_id:                                             <span style="color:#e6db74">&#34;rhel7_64Guest&#34;</span>
      guest_ip_addresses.#:                                 &lt;computed&gt;
      host_system_id:                                       &lt;computed&gt;
      hv_mode:                                              <span style="color:#e6db74">&#34;hvAuto&#34;</span>
      imported:                                             &lt;computed&gt;
      latency_sensitivity:                                  <span style="color:#e6db74">&#34;normal&#34;</span>
      memory:                                               <span style="color:#e6db74">&#34;4096&#34;</span>
      memory_limit:                                         <span style="color:#e6db74">&#34;-1&#34;</span>
      memory_share_count:                                   &lt;computed&gt;
      memory_share_level:                                   <span style="color:#e6db74">&#34;normal&#34;</span>
      migrate_wait_timeout:                                 <span style="color:#e6db74">&#34;30&#34;</span>
      moid:                                                 &lt;computed&gt;
      name:                                                 <span style="color:#e6db74">&#34;kubernetes-controller&#34;</span>
      network_interface.#:                                  <span style="color:#e6db74">&#34;1&#34;</span>
      network_interface.0.adapter_type:                     <span style="color:#e6db74">&#34;vmxnet3&#34;</span>
      network_interface.0.bandwidth_limit:                  <span style="color:#e6db74">&#34;-1&#34;</span>
      network_interface.0.bandwidth_reservation:            <span style="color:#e6db74">&#34;0&#34;</span>
      network_interface.0.bandwidth_share_count:            &lt;computed&gt;
      network_interface.0.bandwidth_share_level:            <span style="color:#e6db74">&#34;normal&#34;</span>
      network_interface.0.device_address:                   &lt;computed&gt;
      network_interface.0.key:                              &lt;computed&gt;
      network_interface.0.mac_address:                      &lt;computed&gt;
      network_interface.0.network_id:                       <span style="color:#e6db74">&#34;network-24&#34;</span>
      num_cores_per_socket:                                 <span style="color:#e6db74">&#34;1&#34;</span>
      num_cpus:                                             <span style="color:#e6db74">&#34;2&#34;</span>
      reboot_required:                                      &lt;computed&gt;
      resource_pool_id:                                     <span style="color:#e6db74">&#34;resgroup-8&#34;</span>
      run_tools_scripts_after_power_on:                     <span style="color:#e6db74">&#34;true&#34;</span>
      run_tools_scripts_after_resume:                       <span style="color:#e6db74">&#34;true&#34;</span>
      run_tools_scripts_before_guest_shutdown:              <span style="color:#e6db74">&#34;true&#34;</span>
      run_tools_scripts_before_guest_standby:               <span style="color:#e6db74">&#34;true&#34;</span>
      scsi_bus_sharing:                                     <span style="color:#e6db74">&#34;noSharing&#34;</span>
      scsi_controller_count:                                <span style="color:#e6db74">&#34;1&#34;</span>
      scsi_type:                                            <span style="color:#e6db74">&#34;lsilogic&#34;</span>
      shutdown_wait_timeout:                                <span style="color:#e6db74">&#34;3&#34;</span>
      swap_placement_policy:                                <span style="color:#e6db74">&#34;inherit&#34;</span>
      uuid:                                                 &lt;computed&gt;
      vmware_tools_status:                                  &lt;computed&gt;
      vmx_path:                                             &lt;computed&gt;
      wait_for_guest_net_routable:                          <span style="color:#e6db74">&#34;true&#34;</span>
      wait_for_guest_net_timeout:                           <span style="color:#e6db74">&#34;5&#34;</span>


Plan: <span style="color:#ae81ff">2</span> to add, <span style="color:#ae81ff">0</span> to change, <span style="color:#ae81ff">0</span> to destroy.

------------------------------------------------------------------------

Note: You didn<span style="color:#e6db74">&#39;t specify an &#34;-out&#34; parameter to save this plan, so Terraform
</span><span style="color:#e6db74">can&#39;</span>t guarantee that exactly these actions will be performed <span style="color:#66d9ef">if</span>
<span style="color:#e6db74">&#34;terraform apply&#34;</span> is subsequently run.

<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h3 id="10-run-terraform-apply-to-create-the-described-resources">10. Run <code>terraform apply</code> to create the described resources.</h3>

<p>Running <code>terraform apply --auto-approve</code> will have terraform create the resource described in <code>main.tf</code>:</p>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># terraform apply --auto-approve</span>
data.vsphere_datacenter.template_datacenter: Refreshing state...
data.vsphere_datastore.vm_datastore: Refreshing state...
data.vsphere_resource_pool.vm_resource_pool: Refreshing state...
data.vsphere_network.vm_network: Refreshing state...
data.vsphere_virtual_machine.template: Refreshing state...
null_resource.generate-sshkey: Creating...
null_resource.generate-sshkey: Provisioning with <span style="color:#e6db74">&#39;local-exec&#39;</span>...
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: Executing: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;/bin/sh&#34;</span> <span style="color:#e6db74">&#34;-c&#34;</span> <span style="color:#e6db74">&#34;yes y | ssh-keygen -b 4096 -t rsa -C &#39;terraform-vsphere-kubernetes&#39; -N &#39;&#39; -f /root/.ssh/id_rsa-terraform-vsphere-kubernetes&#34;</span><span style="color:#f92672">]</span>
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: Generating public/private rsa key pair.
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: /root/.ssh/id_rsa-terraform-vsphere-kubernetes already exists.
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: Overwrite <span style="color:#f92672">(</span>y/n<span style="color:#f92672">)</span>? Your identification has been saved in /root/.ssh/id_rsa-terraform-vsphere-kubernetes.
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: Your public key has been saved in /root/.ssh/id_rsa-terraform-vsphere-kubernetes.pub.
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: The key fingerprint is:
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: SHA256:ybdlc+Ms5FO18zpymVoZTb+ocqLzHOtSxGm6RlEaqMs terraform-vsphere-kubernetes
null_resource.generate-sshkey <span style="color:#f92672">(</span>local-exec<span style="color:#f92672">)</span>: The key<span style="color:#e6db74">&#39;s randomart image is:
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): +---[RSA 4096]----+
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |      .          |
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |     . . .       |
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |    .   = .     o|
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |   .   + *     +o|
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |  . .   S . = =oo|
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |   E   o o * *.++|
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |      . o.. +.=+.|
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |       =.oo.o+=. |
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): |      ..*=+..+.. |
</span><span style="color:#e6db74">null_resource.generate-sshkey (local-exec): +----[SHA256]-----+
</span><span style="color:#e6db74">null_resource.generate-sshkey: Creation complete after 0s (ID: 8831700834679792902)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Creating...
</span><span style="color:#e6db74">  boot_retry_delay:                                     &#34;&#34; =&gt; &#34;10000&#34;
</span><span style="color:#e6db74">  change_version:                                       &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  clone.#:                                              &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  clone.0.customize.#:                                  &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.dns_server_list.#:                &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.dns_server_list.0:                &#34;&#34; =&gt; &#34;192.168.100.1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.dns_suffix_list.#:                &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.dns_suffix_list.0:                &#34;&#34; =&gt; &#34;kubernetes.local&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.ipv4_gateway:                     &#34;&#34; =&gt; &#34;192.168.100.1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.linux_options.#:                  &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.linux_options.0.domain:           &#34;&#34; =&gt; &#34;kubernetes.local&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.linux_options.0.host_name:        &#34;&#34; =&gt; &#34;kubernetes-controller&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.linux_options.0.hw_clock_utc:     &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.network_interface.#:              &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.network_interface.0.ipv4_address: &#34;&#34; =&gt; &#34;192.168.100.100&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.network_interface.0.ipv4_netmask: &#34;&#34; =&gt; &#34;24&#34;
</span><span style="color:#e6db74">  clone.0.customize.0.timeout:                          &#34;&#34; =&gt; &#34;10&#34;
</span><span style="color:#e6db74">  clone.0.template_uuid:                                &#34;&#34; =&gt; &#34;4221e272-e449-97e0-39f4-ab580bebc473&#34;
</span><span style="color:#e6db74">  clone.0.timeout:                                      &#34;&#34; =&gt; &#34;30&#34;
</span><span style="color:#e6db74">  cpu_limit:                                            &#34;&#34; =&gt; &#34;-1&#34;
</span><span style="color:#e6db74">  cpu_share_count:                                      &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  cpu_share_level:                                      &#34;&#34; =&gt; &#34;normal&#34;
</span><span style="color:#e6db74">  datastore_id:                                         &#34;&#34; =&gt; &#34;datastore-15&#34;
</span><span style="color:#e6db74">  default_ip_address:                                   &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  disk.#:                                               &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  disk.0.attach:                                        &#34;&#34; =&gt; &#34;false&#34;
</span><span style="color:#e6db74">  disk.0.datastore_id:                                  &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  disk.0.device_address:                                &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  disk.0.disk_mode:                                     &#34;&#34; =&gt; &#34;persistent&#34;
</span><span style="color:#e6db74">  disk.0.disk_sharing:                                  &#34;&#34; =&gt; &#34;sharingNone&#34;
</span><span style="color:#e6db74">  disk.0.eagerly_scrub:                                 &#34;&#34; =&gt; &#34;false&#34;
</span><span style="color:#e6db74">  disk.0.io_limit:                                      &#34;&#34; =&gt; &#34;-1&#34;
</span><span style="color:#e6db74">  disk.0.io_reservation:                                &#34;&#34; =&gt; &#34;0&#34;
</span><span style="color:#e6db74">  disk.0.io_share_count:                                &#34;&#34; =&gt; &#34;0&#34;
</span><span style="color:#e6db74">  disk.0.io_share_level:                                &#34;&#34; =&gt; &#34;normal&#34;
</span><span style="color:#e6db74">  disk.0.keep_on_remove:                                &#34;&#34; =&gt; &#34;false&#34;
</span><span style="color:#e6db74">  disk.0.key:                                           &#34;&#34; =&gt; &#34;0&#34;
</span><span style="color:#e6db74">  disk.0.label:                                         &#34;&#34; =&gt; &#34;disk0&#34;
</span><span style="color:#e6db74">  disk.0.path:                                          &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  disk.0.size:                                          &#34;&#34; =&gt; &#34;8&#34;
</span><span style="color:#e6db74">  disk.0.thin_provisioned:                              &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  disk.0.unit_number:                                   &#34;&#34; =&gt; &#34;0&#34;
</span><span style="color:#e6db74">  disk.0.uuid:                                          &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  disk.0.write_through:                                 &#34;&#34; =&gt; &#34;false&#34;
</span><span style="color:#e6db74">  ept_rvi_mode:                                         &#34;&#34; =&gt; &#34;automatic&#34;
</span><span style="color:#e6db74">  firmware:                                             &#34;&#34; =&gt; &#34;bios&#34;
</span><span style="color:#e6db74">  force_power_off:                                      &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  guest_id:                                             &#34;&#34; =&gt; &#34;rhel7_64Guest&#34;
</span><span style="color:#e6db74">  guest_ip_addresses.#:                                 &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  host_system_id:                                       &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  hv_mode:                                              &#34;&#34; =&gt; &#34;hvAuto&#34;
</span><span style="color:#e6db74">  imported:                                             &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  latency_sensitivity:                                  &#34;&#34; =&gt; &#34;normal&#34;
</span><span style="color:#e6db74">  memory:                                               &#34;&#34; =&gt; &#34;4096&#34;
</span><span style="color:#e6db74">  memory_limit:                                         &#34;&#34; =&gt; &#34;-1&#34;
</span><span style="color:#e6db74">  memory_share_count:                                   &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  memory_share_level:                                   &#34;&#34; =&gt; &#34;normal&#34;
</span><span style="color:#e6db74">  migrate_wait_timeout:                                 &#34;&#34; =&gt; &#34;30&#34;
</span><span style="color:#e6db74">  moid:                                                 &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  name:                                                 &#34;&#34; =&gt; &#34;kubernetes-controller&#34;
</span><span style="color:#e6db74">  network_interface.#:                                  &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  network_interface.0.adapter_type:                     &#34;&#34; =&gt; &#34;vmxnet3&#34;
</span><span style="color:#e6db74">  network_interface.0.bandwidth_limit:                  &#34;&#34; =&gt; &#34;-1&#34;
</span><span style="color:#e6db74">  network_interface.0.bandwidth_reservation:            &#34;&#34; =&gt; &#34;0&#34;
</span><span style="color:#e6db74">  network_interface.0.bandwidth_share_count:            &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  network_interface.0.bandwidth_share_level:            &#34;&#34; =&gt; &#34;normal&#34;
</span><span style="color:#e6db74">  network_interface.0.device_address:                   &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  network_interface.0.key:                              &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  network_interface.0.mac_address:                      &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  network_interface.0.network_id:                       &#34;&#34; =&gt; &#34;network-24&#34;
</span><span style="color:#e6db74">  num_cores_per_socket:                                 &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  num_cpus:                                             &#34;&#34; =&gt; &#34;2&#34;
</span><span style="color:#e6db74">  reboot_required:                                      &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  resource_pool_id:                                     &#34;&#34; =&gt; &#34;resgroup-8&#34;
</span><span style="color:#e6db74">  run_tools_scripts_after_power_on:                     &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  run_tools_scripts_after_resume:                       &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  run_tools_scripts_before_guest_shutdown:              &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  run_tools_scripts_before_guest_standby:               &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  scsi_bus_sharing:                                     &#34;&#34; =&gt; &#34;noSharing&#34;
</span><span style="color:#e6db74">  scsi_controller_count:                                &#34;&#34; =&gt; &#34;1&#34;
</span><span style="color:#e6db74">  scsi_type:                                            &#34;&#34; =&gt; &#34;lsilogic&#34;
</span><span style="color:#e6db74">  shutdown_wait_timeout:                                &#34;&#34; =&gt; &#34;3&#34;
</span><span style="color:#e6db74">  swap_placement_policy:                                &#34;&#34; =&gt; &#34;inherit&#34;
</span><span style="color:#e6db74">  uuid:                                                 &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  vmware_tools_status:                                  &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  vmx_path:                                             &#34;&#34; =&gt; &#34;&lt;computed&gt;&#34;
</span><span style="color:#e6db74">  wait_for_guest_net_routable:                          &#34;&#34; =&gt; &#34;true&#34;
</span><span style="color:#e6db74">  wait_for_guest_net_timeout:                           &#34;&#34; =&gt; &#34;5&#34;
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (10s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (20s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (30s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (40s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (50s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (1m0s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (1m10s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (1m20s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (1m30s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (1m40s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (1m50s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (2m0s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Still creating... (2m10s elapsed)
</span><span style="color:#e6db74">vsphere_virtual_machine.kubernetes_controller: Provisioning with &#39;</span>file<span style="color:#960050;background-color:#1e0010">&#39;</span>...</code></pre></div>
At this point in the deployment, the virtual machine IP address is reachable from the deploying machine and the ssh public key file has been copied to the deployed virtual machine
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vsphere_virtual_machine.kubernetes_controller: Provisioning with <span style="color:#e6db74">&#39;remote-exec&#39;</span>...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Connecting to remote host via SSH...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Host: <span style="color:#ae81ff">192</span>.168.100.100
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   User: root
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Password: true
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Private key: false
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   SSH Agent: false
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Checking Host Key: false
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Connected!
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Redirecting to /bin/systemctl restart sshd.service</code></pre></div>
The first <code>remote-exec</code> block has just moved the ssh public key to the proper location, disabled ssh password authentioned and the restarted sshd service.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vsphere_virtual_machine.kubernetes_controller: Provisioning with <span style="color:#e6db74">&#39;file&#39;</span>...</code></pre></div>
The <code>./scripts/</code> files have now been copied to the deploy virtual machine. Next the <code>scripts\install_docker.sh</code> script will run remotely to install the necessary packages.
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vsphere_virtual_machine.kubernetes_controller: Provisioning with <span style="color:#e6db74">&#39;remote-exec&#39;</span>...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Connecting to remote host via SSH...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Host: <span style="color:#ae81ff">192</span>.168.100.100
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   User: root
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Password: false
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Private key: true
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   SSH Agent: false
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Checking Host Key: false
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>2m20s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Connected!
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: setenforce: SELinux is disabled
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loaded plugins: fastestmirror
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Determining fastest mirrors
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * base: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * extras: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * updates: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: base             | <span style="color:#ae81ff">3</span>.6 kB     <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: extras           | <span style="color:#ae81ff">3</span>.4 kB     <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: updates          | <span style="color:#ae81ff">3</span>.4 kB     <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>/4<span style="color:#f92672">)</span>: base/7/x86_ | <span style="color:#ae81ff">166</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span>/4<span style="color:#f92672">)</span>: extras/7/x8 | <span style="color:#ae81ff">156</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">3</span>/4<span style="color:#f92672">)</span>: updates/7/x | <span style="color:#ae81ff">1</span>.3 MB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/4<span style="color:#f92672">)</span>: base/7/ <span style="color:#ae81ff">58</span>% | <span style="color:#ae81ff">4</span>.5 MB   --:-- ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/4<span style="color:#f92672">)</span>: base/7/x86_ | <span style="color:#ae81ff">6</span>.0 MB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Package device-mapper-persistent-data-0.7.3-3.el7.x86_64 already installed and latest version
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Package <span style="color:#ae81ff">7</span>:lvm2-2.02.180-10.el7_6.2.x86_64 already installed and latest version
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Resolving Dependencies
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package yum-utils.noarch <span style="color:#ae81ff">0</span>:1.1.31-50.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: python-kitchen <span style="color:#66d9ef">for</span> package: yum-utils-1.1.31-50.el7.noarch
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libxml2-python <span style="color:#66d9ef">for</span> package: yum-utils-1.1.31-50.el7.noarch
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libxml2-python.x86_64 <span style="color:#ae81ff">0</span>:2.9.1-6.el7_2.3 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package python-kitchen.noarch <span style="color:#ae81ff">0</span>:1.1.1-5.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: python-chardet <span style="color:#66d9ef">for</span> package: python-kitchen-1.1.1-5.el7.noarch
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package python-chardet.noarch <span style="color:#ae81ff">0</span>:2.2.1-1.el7_1 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Finished Dependency Resolution

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Dependencies Resolved

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Package
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:       Arch   Version         Repository
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                    Size
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installing:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  yum-utils
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:       noarch <span style="color:#ae81ff">1</span>.1.31-50.el7   base <span style="color:#ae81ff">121</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installing <span style="color:#66d9ef">for</span> dependencies:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libxml2-python
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:       x86_64 <span style="color:#ae81ff">2</span>.9.1-6.el7_2.3 base <span style="color:#ae81ff">247</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  python-chardet
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:       noarch <span style="color:#ae81ff">2</span>.2.1-1.el7_1   base <span style="color:#ae81ff">227</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  python-kitchen
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:       noarch <span style="color:#ae81ff">1</span>.1.1-5.el7     base <span style="color:#ae81ff">267</span> k

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Transaction Summary
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Install  <span style="color:#ae81ff">1</span> Package <span style="color:#f92672">(</span>+3 Dependent packages<span style="color:#f92672">)</span>

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Total download size: <span style="color:#ae81ff">861</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installed size: <span style="color:#ae81ff">4</span>.3 M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Downloading packages:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>/4<span style="color:#f92672">)</span>: libxml2-pyt | <span style="color:#ae81ff">247</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span>/4<span style="color:#f92672">)</span>: python-char | <span style="color:#ae81ff">227</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">3</span>/4<span style="color:#f92672">)</span>: python-kitc | <span style="color:#ae81ff">267</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/4<span style="color:#f92672">)</span>: yum-utils-1 | <span style="color:#ae81ff">121</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ----------------------------------------
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Total      <span style="color:#ae81ff">5</span>.5 MB/s | <span style="color:#ae81ff">861</span> kB  <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction test
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>2m30s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Transaction test succeeded
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installed:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   yum-utils.noarch <span style="color:#ae81ff">0</span>:1.1.31-50.el7

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Dependency Installed:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libxml2-python.x86_64 <span style="color:#ae81ff">0</span>:2.9.1-6.el7_2.3
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   python-chardet.noarch <span style="color:#ae81ff">0</span>:2.2.1-1.el7_1
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   python-kitchen.noarch <span style="color:#ae81ff">0</span>:1.1.1-5.el7

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Complete!
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loaded plugins: fastestmirror
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: adding repo from: https://download.docker.com/linux/centos/docker-ce.repo
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: grabbing file https://download.docker.com/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: repo saved to /etc/yum.repos.d/docker-ce.repo
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loaded plugins: fastestmirror
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loading mirror speeds from cached hostfile
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * base: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * extras: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * updates: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: docker-ce-stable | <span style="color:#ae81ff">3</span>.5 kB     <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>/2<span style="color:#f92672">)</span>: docker-ce-s |   <span style="color:#ae81ff">55</span> B   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span>/2<span style="color:#f92672">)</span>: docker-ce-s |  <span style="color:#ae81ff">19</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: No packages marked <span style="color:#66d9ef">for</span> update
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loaded plugins: fastestmirror
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loading mirror speeds from cached hostfile
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * base: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * extras: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * updates: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Resolving Dependencies
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package docker-ce.x86_64 <span style="color:#ae81ff">0</span>:18.06.1.ce-3.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: container-selinux &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>.9 <span style="color:#66d9ef">for</span> package: docker-ce-18.06.1.ce-3.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libcgroup <span style="color:#66d9ef">for</span> package: docker-ce-18.06.1.ce-3.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libltdl.so.7<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: docker-ce-18.06.1.ce-3.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package container-selinux.noarch <span style="color:#ae81ff">2</span>:2.74-1.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: policycoreutils-python <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">2</span>:container-selinux-2.74-1.el7.noarch
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libcgroup.x86_64 <span style="color:#ae81ff">0</span>:0.41-20.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libtool-ltdl.x86_64 <span style="color:#ae81ff">0</span>:2.4.2-22.el7_3 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package policycoreutils-python.x86_64 <span style="color:#ae81ff">0</span>:2.5-29.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: setools-libs &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>.3.8-4 <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libsemanage-python &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>.5-14 <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: audit-libs-python &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>.1.3-4 <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: python-IPy <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libqpol.so.1<span style="color:#f92672">(</span>VERS_1.4<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libqpol.so.1<span style="color:#f92672">(</span>VERS_1.2<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libapol.so.4<span style="color:#f92672">(</span>VERS_4.0<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: checkpolicy <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libqpol.so.1<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libapol.so.4<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: policycoreutils-python-2.5-29.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package audit-libs-python.x86_64 <span style="color:#ae81ff">0</span>:2.8.4-4.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package checkpolicy.x86_64 <span style="color:#ae81ff">0</span>:2.5-8.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libsemanage-python.x86_64 <span style="color:#ae81ff">0</span>:2.5-14.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package python-IPy.noarch <span style="color:#ae81ff">0</span>:0.75-6.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package setools-libs.x86_64 <span style="color:#ae81ff">0</span>:3.3.8-4.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Finished Dependency Resolution

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Dependencies Resolved

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Package
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    Arch   Version          Repository
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                    Size
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installing:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  docker-ce
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">18</span>.06.1.ce-3.el7 docker-ce-stable
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                    <span style="color:#ae81ff">41</span> M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installing <span style="color:#66d9ef">for</span> dependencies:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  audit-libs-python
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">2</span>.8.4-4.el7      base    <span style="color:#ae81ff">76</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  checkpolicy
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">2</span>.5-8.el7        base   <span style="color:#ae81ff">295</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  container-selinux
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    noarch <span style="color:#ae81ff">2</span>:2.74-1.el7     extras  <span style="color:#ae81ff">38</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libcgroup
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">0</span>.41-20.el7      base    <span style="color:#ae81ff">66</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libsemanage-python
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">2</span>.5-14.el7       base   <span style="color:#ae81ff">113</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libtool-ltdl
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">2</span>.4.2-22.el7_3   base    <span style="color:#ae81ff">49</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  policycoreutils-python
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">2</span>.5-29.el7       base   <span style="color:#ae81ff">456</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  python-IPy
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    noarch <span style="color:#ae81ff">0</span>.75-6.el7       base    <span style="color:#ae81ff">32</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  setools-libs
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:    x86_64 <span style="color:#ae81ff">3</span>.3.8-4.el7      base   <span style="color:#ae81ff">620</span> k

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Transaction Summary
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Install  <span style="color:#ae81ff">1</span> Package <span style="color:#f92672">(</span>+9 Dependent packages<span style="color:#f92672">)</span>

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Total download size: <span style="color:#ae81ff">42</span> M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installed size: <span style="color:#ae81ff">46</span> M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Downloading packages:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>/10<span style="color:#f92672">)</span>: audit-libs |  <span style="color:#ae81ff">76</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span>/10<span style="color:#f92672">)</span>: libcgroup- |  <span style="color:#ae81ff">66</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">3</span>/10<span style="color:#f92672">)</span>: container- |  <span style="color:#ae81ff">38</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/10<span style="color:#f92672">)</span>: libsemanag | <span style="color:#ae81ff">113</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">5</span>/10<span style="color:#f92672">)</span>: checkpolic | <span style="color:#ae81ff">295</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">6</span>/10<span style="color:#f92672">)</span>: libtool-lt |  <span style="color:#ae81ff">49</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">7</span>/10<span style="color:#f92672">)</span>: python-IPy |  <span style="color:#ae81ff">32</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">8</span>/10<span style="color:#f92672">)</span>: policycore | <span style="color:#ae81ff">456</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">9</span>/10<span style="color:#f92672">)</span>: setools-li | <span style="color:#ae81ff">620</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docker <span style="color:#ae81ff">4</span>% | <span style="color:#ae81ff">1</span>.7 MB   --:-- ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">14</span>% | <span style="color:#ae81ff">6</span>.2 MB   <span style="color:#ae81ff">00</span>:06 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">25</span>% |  <span style="color:#ae81ff">11</span> MB   <span style="color:#ae81ff">00</span>:04 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">36</span>% |  <span style="color:#ae81ff">15</span> MB   <span style="color:#ae81ff">00</span>:03 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">46</span>% |  <span style="color:#ae81ff">20</span> MB   <span style="color:#ae81ff">00</span>:03 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">57</span>% |  <span style="color:#ae81ff">24</span> MB   <span style="color:#ae81ff">00</span>:02 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">68</span>% |  <span style="color:#ae81ff">29</span> MB   <span style="color:#ae81ff">00</span>:01 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">78</span>% |  <span style="color:#ae81ff">34</span> MB   <span style="color:#ae81ff">00</span>:01 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docke <span style="color:#ae81ff">89</span>% |  <span style="color:#ae81ff">38</span> MB   <span style="color:#ae81ff">00</span>:00 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: warning: /var/cache/yum/x86_64/7/docker-ce-stable/packages/docker-ce-18.06.1.ce-3.el7.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 621e9f35: NOKEY
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Public key <span style="color:#66d9ef">for</span> docker-ce-18.06.1.ce-3.el7.x86_64.rpm is not installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/10<span style="color:#f92672">)</span>: docker-ce |  <span style="color:#ae81ff">41</span> MB   <span style="color:#ae81ff">00</span>:03
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ----------------------------------------
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Total       <span style="color:#ae81ff">13</span> MB/s |  <span style="color:#ae81ff">42</span> MB  <span style="color:#ae81ff">00</span>:03
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Retrieving key from https://download.docker.com/linux/centos/gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Importing GPG key 0x621E9F35:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Userid     : <span style="color:#e6db74">&#34;Docker Release (CE rpm) &lt;docker@docker.com&gt;&#34;</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Fingerprint: 060a 61c5 1b55 8a7f 742b 77aa c52f eb6b 621e 9f35
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  From       : https://download.docker.com/linux/centos/gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction test
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Transaction test succeeded
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libcgroup-0.41-2    <span style="color:#ae81ff">1</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : checkpolicy-2.5-    <span style="color:#ae81ff">2</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : docker-ce-18.06.    <span style="color:#ae81ff">3</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libsemanage-pyth    <span style="color:#ae81ff">4</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : policycoreutils-    <span style="color:#ae81ff">5</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : python-IPy-0.75-    <span style="color:#ae81ff">6</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libtool-ltdl-2.4    <span style="color:#ae81ff">7</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : <span style="color:#ae81ff">2</span>:container-seli    <span style="color:#ae81ff">8</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : audit-libs-pytho    <span style="color:#ae81ff">9</span>/10
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : setools-libs-3.3   <span style="color:#ae81ff">10</span>/10

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installed:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   docker-ce.x86_64 <span style="color:#ae81ff">0</span>:18.06.1.ce-3.el7

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Dependency Installed:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   audit-libs-python.x86_64 <span style="color:#ae81ff">0</span>:2.8.4-4.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   checkpolicy.x86_64 <span style="color:#ae81ff">0</span>:2.5-8.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   container-selinux.noarch <span style="color:#ae81ff">2</span>:2.74-1.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libcgroup.x86_64 <span style="color:#ae81ff">0</span>:0.41-20.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libsemanage-python.x86_64 <span style="color:#ae81ff">0</span>:2.5-14.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libtool-ltdl.x86_64 <span style="color:#ae81ff">0</span>:2.4.2-22.el7_3
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   policycoreutils-python.x86_64 <span style="color:#ae81ff">0</span>:2.5-29.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   python-IPy.noarch <span style="color:#ae81ff">0</span>:0.75-6.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   setools-libs.x86_64 <span style="color:#ae81ff">0</span>:3.3.8-4.el7

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Complete!
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>2m50s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: setenforce: SELinux is disabled</code></pre></div>
Next the <code>./scripts/install_kubernetes.sh</code> script will be run to install the kuberenetes packages needed:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loaded plugins: fastestmirror
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Loading mirror speeds from cached hostfile
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * base: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * extras: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  * updates: centos.mirror.lstn.net
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: kubernetes/signa |  <span style="color:#ae81ff">454</span> B     <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Retrieving key from https://packages.cloud.google.com/yum/doc/yum-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Importing GPG key 0xA7317B0F:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Userid     : <span style="color:#e6db74">&#34;Google Cloud Packages Automatic Signing Key &lt;gc-team@google.com&gt;&#34;</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Fingerprint: d0bc 747f d8ca f711 <span style="color:#ae81ff">7500</span> d6fa <span style="color:#ae81ff">3746</span> c208 a731 7b0f
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  From       : https://packages.cloud.google.com/yum/doc/yum-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Retrieving key from https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: kubernetes/signa | <span style="color:#ae81ff">1</span>.4 kB     <span style="color:#ae81ff">00</span>:00 !!!
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: kubernetes/primary |  <span style="color:#ae81ff">41</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Resolving Dependencies
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package kubeadm.x86_64 <span style="color:#ae81ff">0</span>:1.13.1-0 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: kubernetes-cni &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>.6.0 <span style="color:#66d9ef">for</span> package: kubeadm-1.13.1-0.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: cri-tools &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>.11.0 <span style="color:#66d9ef">for</span> package: kubeadm-1.13.1-0.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package kubectl.x86_64 <span style="color:#ae81ff">0</span>:1.13.1-0 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package kubelet.x86_64 <span style="color:#ae81ff">0</span>:1.13.1-0 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: socat <span style="color:#66d9ef">for</span> package: kubelet-1.13.1-0.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package nfs-utils.x86_64 <span style="color:#ae81ff">1</span>:1.3.0-0.61.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libtirpc &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>.2.4-0.7 <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: gssproxy &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>.7.0-3 <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: rpcbind <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: quota <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libnfsidmap <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libevent <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: keyutils <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libtirpc.so.1<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libnfsidmap.so.0<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libevent-2.0.so.5<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:nfs-utils-1.3.0-0.61.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package openssl.x86_64 <span style="color:#ae81ff">1</span>:1.0.2k-16.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: make <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:openssl-1.0.2k-16.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package cri-tools.x86_64 <span style="color:#ae81ff">0</span>:1.12.0-0 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package gssproxy.x86_64 <span style="color:#ae81ff">0</span>:0.7.0-21.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libini_config &gt;<span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>.3.1-31 <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libverto-module-base <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libref_array.so.1<span style="color:#f92672">(</span>REF_ARRAY_0.1.1<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libini_config.so.3<span style="color:#f92672">(</span>INI_CONFIG_1.2.0<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libini_config.so.3<span style="color:#f92672">(</span>INI_CONFIG_1.1.0<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libref_array.so.1<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libini_config.so.3<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libcollection.so.2<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libbasicobjects.so.0<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: gssproxy-0.7.0-21.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package keyutils.x86_64 <span style="color:#ae81ff">0</span>:1.5.8-3.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package kubernetes-cni.x86_64 <span style="color:#ae81ff">0</span>:0.6.0-0 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libevent.x86_64 <span style="color:#ae81ff">0</span>:2.0.21-4.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libnfsidmap.x86_64 <span style="color:#ae81ff">0</span>:0.25-19.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libtirpc.x86_64 <span style="color:#ae81ff">0</span>:0.2.4-0.15.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package make.x86_64 <span style="color:#ae81ff">1</span>:3.82-23.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package quota.x86_64 <span style="color:#ae81ff">1</span>:4.01-17.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: quota-nls <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>:4.01-17.el7 <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:quota-4.01-17.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: tcp_wrappers <span style="color:#66d9ef">for</span> package: <span style="color:#ae81ff">1</span>:quota-4.01-17.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package rpcbind.x86_64 <span style="color:#ae81ff">0</span>:0.2.0-47.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package socat.x86_64 <span style="color:#ae81ff">0</span>:1.7.3.2-2.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libbasicobjects.x86_64 <span style="color:#ae81ff">0</span>:0.1.1-32.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libcollection.x86_64 <span style="color:#ae81ff">0</span>:0.7.0-32.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libini_config.x86_64 <span style="color:#ae81ff">0</span>:1.3.1-32.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libpath_utils.so.1<span style="color:#f92672">(</span>PATH_UTILS_0.2.1<span style="color:#f92672">)(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: libini_config-1.3.1-32.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Processing Dependency: libpath_utils.so.1<span style="color:#f92672">()(</span>64bit<span style="color:#f92672">)</span> <span style="color:#66d9ef">for</span> package: libini_config-1.3.1-32.el7.x86_64
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libref_array.x86_64 <span style="color:#ae81ff">0</span>:0.1.5-32.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libverto-libevent.x86_64 <span style="color:#ae81ff">0</span>:0.2.5-4.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package quota-nls.noarch <span style="color:#ae81ff">1</span>:4.01-17.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package tcp_wrappers.x86_64 <span style="color:#ae81ff">0</span>:7.6-77.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ---&gt; Package libpath_utils.x86_64 <span style="color:#ae81ff">0</span>:0.2.1-32.el7 will be installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; Finished Dependency Resolution

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Dependencies Resolved

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Package
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        Arch   Version        Repository
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                    Size
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installing:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  kubeadm
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>.13.1-0       kubernetes
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                   <span style="color:#ae81ff">7</span>.9 M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  kubectl
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>.13.1-0       kubernetes
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                   <span style="color:#ae81ff">8</span>.5 M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  kubelet
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>.13.1-0       kubernetes
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                    <span style="color:#ae81ff">21</span> M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  nfs-utils
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>:1.3.0-0.61.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                              base <span style="color:#ae81ff">410</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  openssl
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>:1.0.2k-16.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                              base <span style="color:#ae81ff">493</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installing <span style="color:#66d9ef">for</span> dependencies:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  cri-tools
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>.12.0-0       kubernetes
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                   <span style="color:#ae81ff">4</span>.2 M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  gssproxy
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.7.0-21.el7   base <span style="color:#ae81ff">109</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  keyutils
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>.5.8-3.el7    base  <span style="color:#ae81ff">54</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  kubernetes-cni
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.6.0-0        kubernetes
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:                                   <span style="color:#ae81ff">8</span>.6 M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libbasicobjects
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.1.1-32.el7   base  <span style="color:#ae81ff">26</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libcollection
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.7.0-32.el7   base  <span style="color:#ae81ff">42</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libevent
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">2</span>.0.21-4.el7   base <span style="color:#ae81ff">214</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libini_config
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">1</span>.3.1-32.el7   base  <span style="color:#ae81ff">64</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libnfsidmap
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.25-19.el7    base  <span style="color:#ae81ff">50</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libpath_utils
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.2.1-32.el7   base  <span style="color:#ae81ff">28</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libref_array
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.1.5-32.el7   base  <span style="color:#ae81ff">27</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libtirpc
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.2.4-0.15.el7 base  <span style="color:#ae81ff">89</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  libverto-libevent
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.2.5-4.el7    base <span style="color:#ae81ff">8</span>.9 k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  make  x86_64 <span style="color:#ae81ff">1</span>:3.82-23.el7  base <span style="color:#ae81ff">420</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  quota x86_64 <span style="color:#ae81ff">1</span>:4.01-17.el7  base <span style="color:#ae81ff">179</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  quota-nls
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        noarch <span style="color:#ae81ff">1</span>:4.01-17.el7  base  <span style="color:#ae81ff">90</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  rpcbind
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">0</span>.2.0-47.el7   base  <span style="color:#ae81ff">60</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  socat x86_64 <span style="color:#ae81ff">1</span>.7.3.2-2.el7  base <span style="color:#ae81ff">290</span> k
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  tcp_wrappers
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:        x86_64 <span style="color:#ae81ff">7</span>.6-77.el7     base  <span style="color:#ae81ff">78</span> k

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Transaction Summary
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">========================================</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Install  <span style="color:#ae81ff">5</span> Packages <span style="color:#f92672">(</span>+19 Dependent packages<span style="color:#f92672">)</span>

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Total download size: <span style="color:#ae81ff">52</span> M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installed size: <span style="color:#ae81ff">237</span> M
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Downloading packages:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span>/24<span style="color:#f92672">)</span>: keyutils-1 |  <span style="color:#ae81ff">54</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">2</span>/24<span style="color:#f92672">)</span>: gssproxy-0 | <span style="color:#ae81ff">109</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/24<span style="color:#f92672">)</span>: 5af5ecd <span style="color:#ae81ff">7</span>% | <span style="color:#ae81ff">4</span>.1 MB   --:-- ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/24<span style="color:#f92672">)</span>: 5af5ec <span style="color:#ae81ff">14</span>% | <span style="color:#ae81ff">7</span>.4 MB   <span style="color:#ae81ff">00</span>:12 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: warning: /var/cache/yum/x86_64/7/kubernetes/packages/5af5ecd0bc46fca6c51cc23280f0c0b1522719c282e23a2b1c39b8e720195763-kubeadm-1.13.1-0.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 3e1ba8d5: NOKEY
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Public key <span style="color:#66d9ef">for</span> 5af5ecd0bc46fca6c51cc23280f0c0b1522719c282e23a2b1c39b8e720195763-kubeadm-1.13.1-0.x86_64.rpm is not installed
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">3</span>/24<span style="color:#f92672">)</span>: 5af5ecd0bc | <span style="color:#ae81ff">7</span>.9 MB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">5</span>/24<span style="color:#f92672">)</span>: <span style="color:#ae81ff">785531</span> <span style="color:#ae81ff">21</span>% |  <span style="color:#ae81ff">11</span> MB   <span style="color:#ae81ff">00</span>:10 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">4</span>/24<span style="color:#f92672">)</span>: 53edc739a0 | <span style="color:#ae81ff">4</span>.2 MB   <span style="color:#ae81ff">00</span>:01
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">5</span>/24<span style="color:#f92672">)</span>: <span style="color:#ae81ff">785531</span> <span style="color:#ae81ff">31</span>% |  <span style="color:#ae81ff">17</span> MB   <span style="color:#ae81ff">00</span>:07 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">5</span>/24<span style="color:#f92672">)</span>: <span style="color:#ae81ff">785531</span> <span style="color:#ae81ff">39</span>% |  <span style="color:#ae81ff">20</span> MB   <span style="color:#ae81ff">00</span>:06 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">5</span>/24<span style="color:#f92672">)</span>: <span style="color:#ae81ff">785531</span> <span style="color:#ae81ff">46</span>% |  <span style="color:#ae81ff">24</span> MB   <span style="color:#ae81ff">00</span>:04 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">5</span>/24<span style="color:#f92672">)</span>: 7855313ff2 | <span style="color:#ae81ff">8</span>.5 MB   <span style="color:#ae81ff">00</span>:01
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">6</span>/24<span style="color:#f92672">)</span>: libbasicob |  <span style="color:#ae81ff">26</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">7</span>/24<span style="color:#f92672">)</span>: libevent-2 | <span style="color:#ae81ff">214</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">8</span>/24<span style="color:#f92672">)</span>: libini_con |  <span style="color:#ae81ff">64</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">9</span>/24<span style="color:#f92672">)</span>: libnfsidma |  <span style="color:#ae81ff">50</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">10</span>/24<span style="color:#f92672">)</span>: libcollec |  <span style="color:#ae81ff">42</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">11</span>/24<span style="color:#f92672">)</span>: libpath_u |  <span style="color:#ae81ff">28</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">12</span>/24<span style="color:#f92672">)</span>: libref_ar |  <span style="color:#ae81ff">27</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">13</span>/24<span style="color:#f92672">)</span>: libtirpc- |  <span style="color:#ae81ff">89</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">14</span>/24<span style="color:#f92672">)</span>: libverto- | <span style="color:#ae81ff">8</span>.9 kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">15</span>/24<span style="color:#f92672">)</span>: make-3.82 | <span style="color:#ae81ff">420</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">16</span>/24<span style="color:#f92672">)</span>: 25cd9 <span style="color:#ae81ff">58</span>% |  <span style="color:#ae81ff">30</span> MB   <span style="color:#ae81ff">00</span>:03 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">16</span>/24<span style="color:#f92672">)</span>: openssl-1 | <span style="color:#ae81ff">493</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">17</span>/24<span style="color:#f92672">)</span>: quota-4.0 | <span style="color:#ae81ff">179</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">18</span>/24<span style="color:#f92672">)</span>: quota-nls |  <span style="color:#ae81ff">90</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">19</span>/24<span style="color:#f92672">)</span>: nfs-utils | <span style="color:#ae81ff">410</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">20</span>/24<span style="color:#f92672">)</span>: rpcbind-0 |  <span style="color:#ae81ff">60</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">21</span>/24<span style="color:#f92672">)</span>: tcp_wrapp |  <span style="color:#ae81ff">78</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">23</span>/24<span style="color:#f92672">)</span>: fe330 <span style="color:#ae81ff">67</span>% |  <span style="color:#ae81ff">35</span> MB   <span style="color:#ae81ff">00</span>:02 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">22</span>/24<span style="color:#f92672">)</span>: socat-1.7 | <span style="color:#ae81ff">290</span> kB   <span style="color:#ae81ff">00</span>:00
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">24</span>/24<span style="color:#f92672">)</span>: fe330 <span style="color:#ae81ff">75</span>% |  <span style="color:#ae81ff">39</span> MB   <span style="color:#ae81ff">00</span>:01 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">24</span>/24<span style="color:#f92672">)</span>: fe330 <span style="color:#ae81ff">83</span>% |  <span style="color:#ae81ff">44</span> MB   <span style="color:#ae81ff">00</span>:01 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">24</span>/24<span style="color:#f92672">)</span>: fe330 <span style="color:#ae81ff">91</span>% |  <span style="color:#ae81ff">48</span> MB   <span style="color:#ae81ff">00</span>:00 ETA
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">23</span>/24<span style="color:#f92672">)</span>: 25cd948f6 |  <span style="color:#ae81ff">21</span> MB   <span style="color:#ae81ff">00</span>:02
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">(</span><span style="color:#ae81ff">24</span>/24<span style="color:#f92672">)</span>: fe33057ff | <span style="color:#ae81ff">8</span>.6 MB   <span style="color:#ae81ff">00</span>:01
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: ----------------------------------------
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Total       <span style="color:#ae81ff">12</span> MB/s |  <span style="color:#ae81ff">52</span> MB  <span style="color:#ae81ff">00</span>:04
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Retrieving key from https://packages.cloud.google.com/yum/doc/yum-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Importing GPG key 0xA7317B0F:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Userid     : <span style="color:#e6db74">&#34;Google Cloud Packages Automatic Signing Key &lt;gc-team@google.com&gt;&#34;</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Fingerprint: d0bc 747f d8ca f711 <span style="color:#ae81ff">7500</span> d6fa <span style="color:#ae81ff">3746</span> c208 a731 7b0f
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  From       : https://packages.cloud.google.com/yum/doc/yum-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Retrieving key from https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Importing GPG key 0x3E1BA8D5:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Userid     : <span style="color:#e6db74">&#34;Google Cloud Packages RPM Signing Key &lt;gc-team@google.com&gt;&#34;</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  Fingerprint: <span style="color:#ae81ff">3749</span> e1ba 95a8 6ce0 <span style="color:#ae81ff">5454</span> 6ed2 f09c 394c 3e1b a8d5
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:  From       : https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction check
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction test
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Transaction test succeeded
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Running transaction
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libbasicobjects-    <span style="color:#ae81ff">1</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : kubelet-1.13.1-0    <span style="color:#ae81ff">2</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : <span style="color:#ae81ff">1</span>:openssl-1.0.2k    <span style="color:#ae81ff">3</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : kubectl-1.13.1-0    <span style="color:#ae81ff">4</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libini_config-1.    <span style="color:#ae81ff">5</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : kubeadm-1.13.1-0    <span style="color:#ae81ff">6</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : <span style="color:#ae81ff">1</span>:quota-nls-4.01    <span style="color:#ae81ff">7</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : cri-tools-1.12.0    <span style="color:#ae81ff">8</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libpath_utils-0.    <span style="color:#ae81ff">9</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libevent-2.0.21-   <span style="color:#ae81ff">10</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : <span style="color:#ae81ff">1</span>:nfs-utils-1.3.   <span style="color:#ae81ff">11</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : gssproxy-0.7.0-2   <span style="color:#ae81ff">12</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libverto-libeven   <span style="color:#ae81ff">13</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libcollection-0.   <span style="color:#ae81ff">14</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : <span style="color:#ae81ff">1</span>:make-3.82-23.e   <span style="color:#ae81ff">15</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libref_array-0.1   <span style="color:#ae81ff">16</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : <span style="color:#ae81ff">1</span>:quota-4.01-17.   <span style="color:#ae81ff">17</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : rpcbind-0.2.0-47   <span style="color:#ae81ff">18</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libnfsidmap-0.25   <span style="color:#ae81ff">19</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : keyutils-1.5.8-3   <span style="color:#ae81ff">20</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : tcp_wrappers-7.6   <span style="color:#ae81ff">21</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : kubernetes-cni-0   <span style="color:#ae81ff">22</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : socat-1.7.3.2-2.   <span style="color:#ae81ff">23</span>/24
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   Verifying  : libtirpc-0.2.4-0   <span style="color:#ae81ff">24</span>/24

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Installed:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   kubeadm.x86_64 <span style="color:#ae81ff">0</span>:1.13.1-0
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   kubectl.x86_64 <span style="color:#ae81ff">0</span>:1.13.1-0
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   kubelet.x86_64 <span style="color:#ae81ff">0</span>:1.13.1-0
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   nfs-utils.x86_64 <span style="color:#ae81ff">1</span>:1.3.0-0.61.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   openssl.x86_64 <span style="color:#ae81ff">1</span>:1.0.2k-16.el7

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Dependency Installed:
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   cri-tools.x86_64 <span style="color:#ae81ff">0</span>:1.12.0-0
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   gssproxy.x86_64 <span style="color:#ae81ff">0</span>:0.7.0-21.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   keyutils.x86_64 <span style="color:#ae81ff">0</span>:1.5.8-3.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   kubernetes-cni.x86_64 <span style="color:#ae81ff">0</span>:0.6.0-0
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libbasicobjects.x86_64 <span style="color:#ae81ff">0</span>:0.1.1-32.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libcollection.x86_64 <span style="color:#ae81ff">0</span>:0.7.0-32.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libevent.x86_64 <span style="color:#ae81ff">0</span>:2.0.21-4.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libini_config.x86_64 <span style="color:#ae81ff">0</span>:1.3.1-32.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libnfsidmap.x86_64 <span style="color:#ae81ff">0</span>:0.25-19.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libpath_utils.x86_64 <span style="color:#ae81ff">0</span>:0.2.1-32.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libref_array.x86_64 <span style="color:#ae81ff">0</span>:0.1.5-32.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libtirpc.x86_64 <span style="color:#ae81ff">0</span>:0.2.4-0.15.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   libverto-libevent.x86_64 <span style="color:#ae81ff">0</span>:0.2.5-4.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   make.x86_64 <span style="color:#ae81ff">1</span>:3.82-23.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   quota.x86_64 <span style="color:#ae81ff">1</span>:4.01-17.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   quota-nls.noarch <span style="color:#ae81ff">1</span>:4.01-17.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   rpcbind.x86_64 <span style="color:#ae81ff">0</span>:0.2.0-47.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   socat.x86_64 <span style="color:#ae81ff">0</span>:1.7.3.2-2.el7
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   tcp_wrappers.x86_64 <span style="color:#ae81ff">0</span>:7.6-77.el7

vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Complete!
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: Created symlink from /etc/systemd/system/multi-user.target.wants/kubelet.service to /etc/systemd/system/kubelet.service.
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: * Applying /usr/lib/sysctl.d/00-system.conf ...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.bridge.bridge-nf-call-ip6tables <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.bridge.bridge-nf-call-iptables <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.bridge.bridge-nf-call-arptables <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: * Applying /usr/lib/sysctl.d/10-default-yama-scope.conf ...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: kernel.yama.ptrace_scope <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: * Applying /usr/lib/sysctl.d/50-default.conf ...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: kernel.sysrq <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: kernel.core_uses_pid <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.ipv4.conf.default.rp_filter <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.ipv4.conf.all.rp_filter <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.ipv4.conf.default.accept_source_route <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.ipv4.conf.all.accept_source_route <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.ipv4.conf.default.promote_secondaries <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.ipv4.conf.all.promote_secondaries <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: fs.protected_hardlinks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: fs.protected_symlinks <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: * Applying /etc/sysctl.d/99-sysctl.conf ...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: * Applying /etc/sysctl.d/k8s.conf ...
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.bridge.bridge-nf-call-ip6tables <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: net.bridge.bridge-nf-call-iptables <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: * Applying /etc/sysctl.conf ...</code></pre></div>
Finally the <code>./script/kubeadm_init.sh</code> script will be remotely run that will pull down the kubernetes docker images, perform a <code>kubeadm init</code> in stand up the kubernetes controller and configure the flannel network componants:
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; pull kubeadm images &lt;--
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/kube-apiserver:v1.13.1
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>3m20s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/kube-controller-manager:v1.13.1
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/kube-scheduler:v1.13.1
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>3m30s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/kube-proxy:v1.13.1
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/pause:3.1
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/etcd:3.2.24
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>3m40s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: <span style="color:#f92672">[</span>config/images<span style="color:#f92672">]</span> Pulled k8s.gcr.io/coredns:1.2.6
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; run <span style="color:#e6db74">&#39;kubeadm init&#39;</span> &lt;--
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>3m50s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller: Still creating... <span style="color:#f92672">(</span>4m0s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; setup /root/.kube/config &lt;--
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: --&gt; install flannel &lt;--
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: clusterrole.rbac.authorization.k8s.io/flannel created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: clusterrolebinding.rbac.authorization.k8s.io/flannel created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: serviceaccount/flannel created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: configmap/kube-flannel-cfg created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: daemonset.extensions/kube-flannel-ds-amd64 created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: daemonset.extensions/kube-flannel-ds-arm64 created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: daemonset.extensions/kube-flannel-ds-arm created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: daemonset.extensions/kube-flannel-ds-ppc64le created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>: daemonset.extensions/kube-flannel-ds-s390x created
vsphere_virtual_machine.kubernetes_controller <span style="color:#f92672">(</span>remote-exec<span style="color:#f92672">)</span>:   kubeadm join <span style="color:#ae81ff">192</span>.168.100.100:6443 --token 4xr954.lv1sp4plkapb0eza --discovery-token-ca-cert-hash sha256:0d972b6d7e08ebef346a8cf14ea4bcf88b9341351d7ec4d488defdbb4761e5e8
vsphere_virtual_machine.kubernetes_controller: Creation complete after 4m7s <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">42210435</span>-ffe9-b519-6191-10dae7698a78<span style="color:#f92672">)</span>

Apply complete! Resources: <span style="color:#ae81ff">2</span> added, <span style="color:#ae81ff">0</span> changed, <span style="color:#ae81ff">0</span> destroyed.

Outputs:

ip <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
    <span style="color:#ae81ff">192</span>.168.100.100
<span style="color:#f92672">]</span>
vm-moref <span style="color:#f92672">=</span> vm-1131
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div></p>

<p>The bottom of the <code>terraform appy</code> displays the IP address and moref of the vm that was specified in the <code>output.tf</code> file. I also want to point out the output returned in the last <code>remote-exec</code> block:</p>

<p>kubeadm join 192.168.100.100:6443 &ndash;token 4xr954.lv1sp4plkapb0eza &ndash;discovery-token-ca-cert-hash sha256:0d972b6d7e08ebef346a8cf14ea4bcf88b9341351d7ec4d488defdbb4761e5e8</p>

<p>This is the <code>kubeadm join</code> command that can be run on any kubernetes node to join them to the kubernetes controller we initialized.</p>

<h3 id="11-validate-kubectl-is-working-by-connecting-to-the-deployed-virtual-machine">11. Validate <code>kubectl</code> is working by connecting to the deployed virtual machine.</h3>

<p>You can no longer ssh to the deployed virtual machine using the password from the template, but you can use the ssh key generated to connect without a password like in the following example:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># ssh root@192.168.100.100 -i /root/.ssh/id_rsa-terraform-vsphere-kubernetes</span>
The authenticity of host <span style="color:#e6db74">&#39;192.168.100.100 (192.168.100.100)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span><span style="color:#e6db74">ECDSA key fingerprint is SHA256:dpAptyG7C1yv/tiAT2FU6t/nI9EYJcrD0uNjNr1SldM.
</span><span style="color:#e6db74">ECDSA key fingerprint is MD5:3e:2e:2f:86:57:34:fc:9b:b6:ff:ff:42:df:8b:33:fe.
</span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no)? yes
</span><span style="color:#e6db74">Warning: Permanently added &#39;</span><span style="color:#ae81ff">192</span>.168.100.100<span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span> to the list of known hosts.
Last login: Thu Dec <span style="color:#ae81ff">27</span> <span style="color:#ae81ff">22</span>:22:14 <span style="color:#ae81ff">2018</span> from <span style="color:#ae81ff">192</span>.168.1.8
<span style="color:#f92672">[</span>root@kubernetes-controller ~<span style="color:#f92672">]</span><span style="color:#75715e"># kubectl get nodes</span>
NAME                    STATUS   ROLES    AGE   VERSION
kubernetes-controller   Ready    master   5m    v1.13.1
<span style="color:#f92672">[</span>root@kubernetes-controller ~<span style="color:#f92672">]</span><span style="color:#75715e"># exit</span>
logout
Connection to <span style="color:#ae81ff">192</span>.168.100.100 closed.
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<p>The output of <code>kubectl get nodes</code> shows that the controller node is in a <code>Ready</code> state.</p>

<h3 id="12-run-terraform-destroy-to-delete-the-resources-that-were-previously-created">12. Run <code>terraform destroy</code> to delete the resources that were previously created.</h3>

<p>Once you are ready to destroy the virtual machine terraform created, you can simply run <code>terraform destroy --force</code> to have terraform destroy it:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span><span style="color:#75715e"># terraform destroy --force</span>
null_resource.generate-sshkey: Refreshing state... <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">8831700834679792902</span><span style="color:#f92672">)</span>
data.vsphere_datacenter.template_datacenter: Refreshing state...
data.vsphere_datastore.vm_datastore: Refreshing state...
data.vsphere_network.vm_network: Refreshing state...
data.vsphere_virtual_machine.template: Refreshing state...
data.vsphere_resource_pool.vm_resource_pool: Refreshing state...
vsphere_virtual_machine.kubernetes_controller: Refreshing state... <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">42210435</span>-ffe9-b519-6191-10dae7698a78<span style="color:#f92672">)</span>
null_resource.generate-sshkey: Destroying... <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">8831700834679792902</span><span style="color:#f92672">)</span>
null_resource.generate-sshkey: Destruction complete after 0s
vsphere_virtual_machine.kubernetes_controller: Destroying... <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">42210435</span>-ffe9-b519-6191-10dae7698a78<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller: Still destroying... <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">42210435</span>-ffe9-b519-6191-10dae7698a78, 10s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller: Still destroying... <span style="color:#f92672">(</span>ID: <span style="color:#ae81ff">42210435</span>-ffe9-b519-6191-10dae7698a78, 20s elapsed<span style="color:#f92672">)</span>
vsphere_virtual_machine.kubernetes_controller: Destruction complete after 30s

Destroy complete! Resources: <span style="color:#ae81ff">2</span> destroyed.
<span style="color:#f92672">[</span>root@terraform terraform-vsphere-kubernetes<span style="color:#f92672">]</span>#</code></pre></div>

<h4 id="i-hope-this-post-has-been-useful-in-demonstrating-how-to-clone-a-vsphere-virtual-machine-from-template-using-terraform-the-files-that-were-using-in-this-post-can-be-found-in-a-href-https-github-com-sdorsett-terraform-vsphere-kubernetes-this-github-repository-a">I hope this post has been useful in demonstrating how to clone a vsphere virtual machine from template using terraform. The files that were using in this post can be found in <a href="https://github.com/sdorsett/terraform-vsphere-kubernetes">this github repository</a>.</h4>

<hr />

<h4 id="please-provide-any-feedback-or-suggestions-to-my-twitter-account-located-on-the-about-page">Please provide any feedback or suggestions to my twitter account located on the about page.</h4>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://sdorsett.github.io/post/2018-12-24-using-gitignore-to-keep-terraform-secrets-secret/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://sdorsett.github.io/post/2018-12-24-using-gitignore-to-keep-terraform-secrets-secret/">Using .gitignore to keep terraform secrets secret</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="https://sdorsett.github.iojs/ui.js"></script>
<script src="https://sdorsett.github.iojs/menus.js"></script>






</body>
</html>

